---
title: "Node.js v24環境だけどv20で開発したい！WindowsユーザーのためのVolta導入ガイド【2025年版】"
emoji: "🪄"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["nodejs", "windows", "volta", "nextjs"]
published: true
---

ちょっと前にNode.js の **v24 (Active LTS)** がリリースされましたね。私の PC も早速 v24 にアップデートしたのですが、ここで一つ問題が発生しました。

> 「今作っている Next.js のプロジェクト、v20 ベースで進めたいんだけど……」

- 最新の Node.js v24 が入った PC で、v20 想定のプロジェクトを開発しても大丈夫なのか？
- そのまま デプロイして動くのか？

結論から言うと、

> **「動くかもしれないけど、リスクが高いので環境を合わせたほうがいい」**

です。

この記事では、**Windows 環境（WSL なし）**で、プロジェクトごとに Node.js のバージョンを爆速で切り替えてくれるツール **「Volta」** の導入方法をまとめます。

---

## なぜバージョンを合わせる必要があるの？

一言で言うと、

> **「自分の PC では動いたのに、本番（Vercel など）で動かない」という事故を防ぐため**

です。

2025年11月現在、Node.js v24 には新しい機能が含まれています。もしうっかり開発中にその新機能を使ってしまうと、**v20 で動くサーバー上ではエラー**になってしまいます。

ありがちなパターンとしては：

- 開発マシン: Node.js v24
- 本番 or CI / Vercel: Node.js v20 系

この状態で v24 の API や挙動に依存したコードを書いてしまうと、**本番だけコケる**というつらい状況になります。

そこで役に立つのが、

> **「PC 全体は v24 だけど、このプロジェクトフォルダの中だけは v20 として振る舞う」**

ことができるツールです。今回はそれを **Volta** で実現します。

---

## なぜ nvm-windows ではなく Volta ？

Windows での Node.js バージョン管理といえば `nvm-windows` が有名ですが、私は **Volta 推し**です。その理由はこのあたりです。

- **ディレクトリ移動だけで自動切り替え**  
  `nvm use ...` と毎回打つ必要がありません。  
  対象フォルダに入った瞬間、**勝手にバージョンが切り替わります。**

- **速い（Rust 製）**  
  Volta は Rust で実装されており、動作が非常に高速です。

- **設定がチームで共有しやすい**  
  `package.json` に設定が書き込まれるので、リポジトリをクローンしたチームメンバーも、**同じバージョンを自然に使いやすい**です。

個人開発でもチーム開発でも、**「プロジェクトごとに Node のバージョンを固定したい」**というニーズにきれいにハマります。

---

## Volta の導入手順（Windows 編）

ここからは、**WSL ではなく、通常の Windows 環境**へのインストール手順です。

### 1. 事前準備：開発者モードを ON にする

ここが **一番のハマりポイント**です。

Volta は **シンボリックリンク（ショートカットのような機能）** を使用するため、Windows の **「開発者モード」** が必要になります。

1. Windows の **[設定]** を開く
2. **[システム] > [開発者向け]** を開く
3. **「開発者モード」** を **オン** にする
4. 警告ダイアログが出たら **「はい」** を選択

これをやっていないと、インストール時や実行時にうまく動かないことがあります。

---

### 2. Volta のインストール

インストール自体はとても簡単です。  
**PowerShell または コマンドプロンプト**を開き、以下を実行します。

```powershell
winget install Volta.Volta
```

インストールが終わったら、**ターミナルを一度完全に閉じて、再起動**してください（PATH を反映させるため）。

再度ターミナルを開いて、以下のコマンドで確認します。

```powershell
volta -v
# バージョン番号が表示されればOK！
```

これで Volta の導入は完了です。

---

## プロジェクトごとに Node.js のバージョンを固定する

ここからが本番です。

> **「普段は v24、特定のプロジェクトだけ v20」**

にする設定を行います。

### 1. 使いたいバージョン（v20）をインストール

まずは、PC に Node.js v20 を Volta 経由でインストールします。

```powershell
volta install node@20
```

これで Volta の管理下に **Node.js v20** が追加されます。

---

### 2. プロジェクトフォルダで「ピン留め」する

次に、対象の Next.js プロジェクト（または任意の Node プロジェクト）のフォルダに移動して、バージョンを「ピン留め」します。

```powershell
cd C:\Users\username\Projects\my-nextjs-app
volta pin node@20
```

これを実行すると、`package.json` の末尾あたりに、以下のような設定が **自動で追記**されます。

```json
"volta": {
  "node": "20.x.x"
}
```

この `volta` セクションが、**「このプロジェクトは Node.js 20 系で動かす」** という宣言になります。

---

### 3. 実際に切り替わっているか確認する

設定はこれだけで完了です。  
念のため、プロジェクトフォルダ内で `node -v` を叩いてみましょう。

```powershell
node -v
# -> v20.x.x と表示されるはず！
```

- このフォルダ **の外** では、グローバルの Node.js（例: v24）が使われ、
- このフォルダ **の中** では、自動的に v20 が使われます。

> フォルダから出ると元のバージョン（v24 など）に戻り、またこのフォルダに入ると自動で v20 になる――  
> **めちゃくちゃ便利！”**

